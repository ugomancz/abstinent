<html>

<head>
    <meta charset="UTF-8">
    <title>Myšáci na běhu</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="images/icon.png">
    <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>
    <div class="header">
        <img src="images/cheddar.png" alt="logod" />
        <div class="title">
            <h1>Myšáci na běhu</h1>
        </div>
    </div>
    <div class="upper-body-grid">
        <div class="upper-body-grid-left">
            <div class="text">
                <p>Zajímá Vás kolik toho dneska Abstinent s Alkoholikem uběhli? Jak si udržují své štíhlé postavy a co
                    musíte udělat pro to, abyste měli taky takové summer body?</p>
                <p>Pak jste tady správně!</p>
                <table class="table">
                    <tbody>
                        <tr>
                            <td><strong>Celková uběhnutá vzdálenost:&nbsp;</strong></td>
                            <td><strong><span id="totalDistance">0</span> m</strong></td>
                        </tr>
                        <tr>
                            <td><strong>Maximální rychlost:&nbsp;</strong></td>
                            <td><strong><span id="topSpeed">0</span> m/s</strong> (<span id="topSpeedKm">0</span> km/h)
                                <span id="topSpeedDatetime">0</span>
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Současná rychlost:&nbsp;</strong></td>
                            <td><strong><span id="currentSpeed">0</span> m/s</strong> (<span
                                    id="currentSpeedKm">0</span> km/h)</td>
                        </tr>
                        <tr>
                            <td><strong>Poslední běh:&nbsp;</strong></td>
                            <td><strong><span id="lastRunDatetime">0</span></strong></td>
                        </tr>
                    </tbody>
                </table>
                <p>Jídlo dne: <strong>Slunečnicová semínka</strong></p>
            </div>
        </div>
        <div class="upper-body-grid-right">
            <!-- Add a placeholder for the Twitch embed -->
            <div id="twitch-embed"></div>

            <!-- Load the Twitch embed script -->
            <script src="https://embed.twitch.tv/embed/v1.js"></script>

            <!-- Create a Twitch.Embed object that will render within the "twitch-embed" root element. -->
            <script type="text/javascript">
                new Twitch.Embed("twitch-embed", {
                    width: "100%",
                    height: "100%",
                    channel: "ugomancz",
                    muted: true,
                    autoplay: true,
                    layout: "video",
                    theme: "dark"
                });
            </script>
        </div>
    </div>

    <div class="middle-body">
        <h2>Novinky</h2>
        <div class="middle-body-grid">
            <div class="middle-body-grid-left">
                <h3>Rozšiřujeme řady</h3>
                <p>Jak možná někteří víte, myši jsou poměrně sociální stvoření. Všichni si teď zkoušíme jaké to je, být
                    zavření většinu času doma a setkávat se s přáteli jen zřídka. To jsme Abstinentovi přece nemohli
                    udělat, tak jsme se rozhodli, že mu pořídíme kamaráda.</p>
                <p>Po pár dnech přemýšlení a plánování jsme tak během výletu do obchodu přibrali novou myš. Říkáme jí
                    Alkoholik, aby se navzájem pěkně doplňovali (a taky aby tady mezi nás více zapadla, heh).</p>
                <p>Ze začátku jsme měli obavy, jak si spolu budou rozumět, přeci jen Abstinent je myš divoká, zatímco
                    Alkoholik je ze zverimexu, ale dopadlo to dobře a po pár dnech se zkamarádili. Jediné co nás ještě
                    trochu trápí je, jestli jsme trefili dobře kombinaci pohlaví. Odborná prohlídka nedodala přesné
                    výsledky, takže jsme to spíš odhadli a uvidíme. Při nejhorším má spolubydlící hada...</p>
            </div>
            <div class="middle-body-grid-right">
                <h3>Stěhování</h3>
                <p>Po pár měsících společného soužití s Abstinentem se ukázalo, že by mu asi vyhovovalo mít trochu více
                    místa na nějaké ty schovky a aby nemusel pořád běhat jen v kole. Došli jsme tedy k závěru, že mu
                    zařídíme stěhování.</p>
                <p>Nakonec jsme sehnali klec z druhé ruky, po nějakých křečcích, kterou nám ochotný majitel prodal
                    včetně příslušenství a dokonce i dovezl až k nám domů. Dostali jsme tedy klec, prolézačky, nové
                    kolo, dřevěný domeček i nějaký zbytek jídla a podestýlky.</p>
                <p>Stěhování pro něj byla docela stresující záležitost, ale na svůj nový domov si brzy zvykl a myslíme
                    si, že na starou klec si teď už ani nevzpomene.</p>
            </div>
        </div>
    </div>
    <div class="lower-body">
        <h2>Vznik téhle stránky</h2>
        <div class="lower-body-grid">
            <div class="lower-body-grid-left">
                <h3>Kde se vzal, tu se vzal, Abstinent na lince stál</h3>
                <p>Abstinenta jsme poprvé zahlédli 14. září 2020 kolem poledne.</p>
                <p>Zrovna jsem vstal, šel si dělat snídani a on si vesele pobíhal po kuchyňské lince a hledal něco k
                    snědku.
                    Chvíli jsem si myslel, že se mi to jenom zdá, ale hned co jsem se vzpamatoval, jsem se rozhodl ho
                    chytit. Prvních pár hodin zůstal v půllitru, byl jsem zrovna na cestě do školy a neměl čas to řešit,
                    ale
                    ještě odpoledne toho dne jsme dospěli k rozhodnutí, že si ho necháme a dále trávil svůj čas v
                    terárku po
                    hadovi.</p>
                <p>Po pár týdnech se nám povedlo sehnat vlastní klec, protože se měl had brzo vrátit a asi by si moc
                    nerozuměli. Klec se mu určitě líbila… teda, nestěžoval si, jen to vypadalo, že se docela nudí, takže
                    jsme mu pořídili kolo. Věděli jste, že se povedlo provést experiment, kde myši ve volné přírodě
                    dobrovolně běhaly v kolech nastražených vědci? Ano, myši běhání v kole skutečně baví a u Abstinenta
                    tomu
                    není jinak.</p>
                <p>No a od momentu kdy bylo kolo už chyběl jenom jeden dárek k Vánocům a zrodila se tahle myšlenka.</p>
            </div>
            <div class="lower-body-grid-right">
                <h3>Jak tohle všechno funguje?</h3>
                <p>Začíná to měřením otáček kola. To se realizuje pomocí NodeMCU ESP8266 mikrokontroleru s KY-003
                    magnetickým senzorem a 4 magnetů přilepených přímo na kole. Pokaždé co senzor detekuje magnet,
                    započítá se čtvrt otáčky.</p>
                <p>Počet nových otáček se každé dvě vteřiny odešle na web pomocí http requestu, kde se nová data uloží
                    do databáze a aktualizují se hodnoty zobrazené na stránce.</p>
                <p>Co se livestreamu týče, ze začátku byl realizován starým telefonem, který ale po týdnu nepřetržitého
                    vysílání přestal fungovat. Následovalo shánení nového zařízení a nyní opět stream probíhá se starým
                    telefonem, ale tentokrát funkčním. Přidali jsme i čočku s efektem rybího oka, aby byla klec vidět
                    celá. Všechno vypadalo dobře až do doby, než se ukázalo, že tento telefon se během streamování
                    rychleji vybíjí než nabíjí a ani všechny možné změny nastavení tomu nakonec nedokázaly zabránit.
                    Momentálně se tak chystáme vyzkoušet ještě jeden telefon, který se nám dostal do rukou. Tak snad to
                    napotřetí už vyjde.</p>
            </div>
        </div>
    </div>

    <div class="footer-grid">
        <div class="footer-grid-left">
            <a><img src="images/business.jpg" width="100" height="100" /></a>
            <div class="gift-text">Chcete myšákům přispět na pár sušených banánů nebo nám na pivo, ať se
                nám lépe programuje? <a href="https://www.paypal.com/paypalme/ugoman" rel="noopener">Můžete třeba
                    takto!</a>
                <3</p>
            </div>
        </div>
        <div class="footer-grid-right">
            <a><img src="images/repair.png" width="100" height="100" /></a>
            <div class="fix-text">
                Něco nám nefunguje? Ozvěte se na twitter <a href="https://twitter.com/ondrakostik"
                    rel="noopener">@ondrakostik</a>, zkusíme to opravit.</p>
            </div>
        </div>
        <div class="counter">
            <a href='https://www.symptoma.com/en/info/covid-19'>COVID-19 Check</a> <script type='text/javascript' src='https://www.freevisitorcounters.com/auth.php?id=0c43725184a289996fcdcd2de80f05ee476ac711'></script>
            <script type="text/javascript" src="https://www.freevisitorcounters.com/en/home/counter/820330/t/6"></script>
        </div>
    </div>
</body>


<script>
    function timestampToPrettyDate(timestamp) {
        return new Date((timestamp + 3600) * 1000).toISOString().slice(0, 19).replace('T', ' ');
    }
    function update_stats() {
        fetch('current_data.json?no-cache=' + (new Date().getTime()))
            .then(res => res.json())
            .then(res => {
                console.log(res);
                document.getElementById("totalDistance").innerHTML = res.totalDistance;
                document.getElementById("topSpeed").innerHTML = res.topSpeed;
                document.getElementById("topSpeedKm").innerHTML = res.topSpeedKm;
                document.getElementById("topSpeedDatetime").innerHTML = "[" + timestampToPrettyDate(res.topSpeedTimestamp) + "]";
                document.getElementById("currentSpeed").innerHTML = res.currentSpeed;
                document.getElementById("currentSpeedKm").innerHTML = res.currentSpeedKm;
                document.getElementById("lastRunDatetime").innerHTML = timestampToPrettyDate(res.currentTimestamp);
            });
    }
    update_stats();
    setInterval(function () {
        update_stats();
    }, 2000);

</script>

</html>